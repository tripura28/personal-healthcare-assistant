<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Personal Healthcare Assistant</title>
    <!-- React and ReactDOM via CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f5f5f5; }
        h1 { color: #2e7d32; }
        .card { background: white; padding: 20px; margin: 10px 0; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);}
        input, button { padding: 8px; margin: 5px 0; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #2e7d32; color: white; }
    </style>
</head>
<body>
    <h1>Personal Healthcare Assistant</h1>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function App() {
            const [trimester, setTrimester] = useState('');
            const [condition, setCondition] = useState('');
            const [pregnancyResult, setPregnancyResult] = useState(null);
            const [patientResult, setPatientResult] = useState(null);
            const [history, setHistory] = useState([]);

            const getPregnancy = async () => {
                const res = await fetch('http://127.0.0.1:5000/pregnant/recommendation', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ trimester })
                });
                const data = await res.json();
                setPregnancyResult(data);
                setHistory(prev => [...prev, { type: 'Pregnancy', input: trimester, result: data.diet || 'No recommendation' }]);
            };

            const getPatient = async () => {
                const res = await fetch('http://127.0.0.1:5000/patient/recommendation', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ condition })
                });
                const data = await res.json();
                setPatientResult(data);
                setHistory(prev => [...prev, { type: 'Patient', input: condition, result: data.medications || 'No recommendation' }]);
            };

            return (
                <div>
                    <div className="card">
                        <h2>Pregnant Dietary Recommendation</h2>
                        <input type="number" placeholder="Trimester 1-3" value={trimester} onChange={e => setTrimester(e.target.value)} />
                        <button onClick={getPregnancy}>Get Recommendation</button>
                        {pregnancyResult && <div>
                            <p><b>Diet:</b> {pregnancyResult.diet}</p>
                            <p><b>Supplements:</b> {pregnancyResult.supplements}</p>
                            <p><b>Next Checkup:</b> {pregnancyResult.next_checkup}</p>
                        </div>}
                    </div>

                    <div className="card">
                        <h2>Patient Recommendation</h2>
                        <input type="text" placeholder="Condition" value={condition} onChange={e => setCondition(e.target.value)} />
                        <button onClick={getPatient}>Get Recommendation</button>
                        {patientResult && <div>
                            <p><b>Medications:</b> {patientResult.medications}</p>
                            <p><b>Diet:</b> {patientResult.diet}</p>
                            <p><b>Exercise:</b> {patientResult.exercise}</p>
                        </div>}
                    </div>

                    <div className="card">
                        <h2>History</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Input</th>
                                    <th>Result</th>
                                </tr>
                            </thead>
                            <tbody>
                                {history.map((h, i) => (
                                    <tr key={i}>
                                        <td>{h.type}</td>
                                        <td>{h.input}</td>
                                        <td>{h.result}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>

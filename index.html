<!DOCTYPE html>
<html>
<head>
  <title>Personal Healthcare Assistant</title>

  <!-- React CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family: Arial; margin: 20px; background: #f5f7fa; }
    .card { border: 1px solid #ccc; padding: 15px; margin: 10px 0; border-radius: 8px; background: #fff; box-shadow: 1px 1px 5px rgba(0,0,0,0.1); }
    h1, h2 { color: #2a7f62; }
    input { padding: 8px; margin-right: 10px; }
    button { padding: 8px 12px; background: #2a7f62; color: white; border: none; border-radius: 5px; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #2a7f62; color: white; }
  </style>
</head>
<body>
  <h1>Personal Healthcare Assistant</h1>

  <div id="root"></div>

  <script type="text/javascript">
    const e = React.createElement;

    function App() {
      const [pregResult, setPregResult] = React.useState({});
      const [patientResult, setPatientResult] = React.useState({});
      const [trimester, setTrimester] = React.useState('');
      const [condition, setCondition] = React.useState('');
      const [history, setHistory] = React.useState([]);

      const getPregRecommendation = () => {
        if (!trimester) return alert('Enter trimester');
        fetch('http://127.0.0.1:5000/pregnant/recommendation', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ trimester })
        })
        .then(res => res.json())
        .then(data => {
          setPregResult(data);
          setHistory(prev => [...prev, { type: 'Pregnant', input: trimester, result: data }]);
        });
      };

      const getPatientRecommendation = () => {
        if (!condition) return alert('Enter condition');
        fetch('http://127.0.0.1:5000/patient/recommendation', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ condition })
        })
        .then(res => res.json())
        .then(data => {
          setPatientResult(data);
          setHistory(prev => [...prev, { type: 'Patient', input: condition, result: data }]);
        });
      };

      return e('div', null,
        e('h2', null, 'Pregnant Dietary Recommendation'),
        e('input', { type: 'number', placeholder: 'Trimester', value: trimester, onChange: e => setTrimester(e.target.value) }),
        e('button', { onClick: getPregRecommendation }, 'Get Recommendation'),
        pregResult.diet && e('div', { className: 'card' },
          e('p', null, `Diet: ${pregResult.diet}`),
          e('p', null, `Supplements: ${pregResult.supplements}`),
          e('p', null, `Next Checkup: ${pregResult.next_checkup}`)
        ),

        e('h2', null, 'Patient Dietary Recommendation'),
        e('input', { type: 'text', placeholder: 'Condition', value: condition, onChange: e => setCondition(e.target.value) }),
        e('button', { onClick: getPatientRecommendation }, 'Get Recommendation'),
        patientResult.medications && e('div', { className: 'card' },
          e('p', null, `Medications: ${patientResult.medications}`),
          e('p', null, `Diet: ${patientResult.diet}`),
          e('p', null, `Exercise: ${patientResult.exercise}`)
        ),

        e('h2', null, 'History'),
        e('table', null,
          e('thead', null,
            e('tr', null,
              e('th', null, 'Type'),
              e('th', null, 'Input'),
              e('th', null, 'Result')
            )
          ),
          e('tbody', null,
            history.map((h, idx) => e('tr', { key: idx },
              e('td', null, h.type),
              e('td', null, h.input),
              e('td', null, JSON.stringify(h.result))
            ))
          )
        )
      );
    }

    ReactDOM.render(e(App), document.getElementById('root'));
  </script>
</body>
</html>
